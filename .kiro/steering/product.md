# Product Overview

## Product Description
JSON Compare は、機械学習モデルの出力結果（JSONLファイル）を比較・評価するための専門的なCLIツールです。特に日本語テキストの意味的類似度を高精度で計算し、モデルの一貫性と品質を定量的に評価します。従来の埋め込みベースの比較に加えて、LLM（大規模言語モデル）による高度な意味理解での類似度判定もサポートしています。

## Core Features
- **日本語特化の類似度計算**: cl-nagoya/ruri-v3-310m埋め込みモデルによる高精度な意味比較
- **LLMベース類似度判定**: vLLM API経由でLLMによる高度な意味理解での比較（オプション機能）
- **比較方法の明示的識別**: LLMベースと埋め込みベースの比較結果を明確に区別し、使用した手法をメタデータで識別
- **2つの推論結果比較**: `inference1`と`inference2`フィールドの自動比較
- **2ファイル比較機能**: 2つの異なるJSONLファイルの指定列を比較
- **柔軟な出力形式**: 全体スコアサマリー（score）と詳細行別分析（file）
- **戦略パターン計算**: 埋め込みモード/LLMモードの動的切り替え可能
- **プロンプトテンプレート管理**: カスタマイズ可能なYAMLベースのプロンプト設定
- **uvx対応**: インストール不要で即座に実行可能なCLIツール
- **CPU/GPU両対応**: デフォルトCPU動作で軽量、GPU利用で高速処理
- **JSON自動修復**: json-repairによる破損JSONの自動修復機能
- **複数行JSON自動修正**: 複数行にまたがるJSONオブジェクトを1行1オブジェクト形式に自動変換
- **Web UI**: ドラッグ&ドロップ対応のモダンなインターフェース（ポート18081）
- **WebUI進捗表示** [計画中]: リアルタイム処理進捗、経過時間、推定残り時間の表示
- **RESTful API**: FastAPIによる完全なAPI実装（単一/2ファイル/LLM比較、メトリクス、ヘルスチェック）
- **プログレスバー表示**: 大規模ファイル処理時の進捗表示（tqdm）
- **タイムアウト対策**: 処理時間の最適化とタイムアウト防止機能
- **メトリクス収集**: LLM使用統計、応答時間、エラー率の追跡
- **Playwright MCP包括テスト**: AIアシスタント統合による完全自動化テストフレームワーク
- **リソースキャッシング**: LLM応答とリソースの効率的なキャッシングシステム
- **設定管理システム**: 高度な設定ファイル管理とバリデーション機能
- **包括的エラーハンドリング**: 詳細なエラー追跡とリカバリ機能

## Target Use Case
- **MLモデル評価**: 異なるモデルや設定での推論結果の一貫性評価
- **A/Bテスト**: 2つのモデルバージョンの出力品質比較
- **品質保証**: プロダクション投入前のモデル出力の品質チェック
- **日本語NLP開発**: 日本語処理モデルの開発・改善における定量評価
- **バッチ処理**: 大量のJSONLファイルの自動評価とレポート生成
- **高度な意味比較**: LLMを活用した文脈考慮の類似度判定
- **カスタム評価基準**: プロンプトテンプレートによる評価軸のカスタマイズ
- **包括的テスト自動化**: Playwright MCPによる完全自動化されたWebUI機能テスト
- **比較手法の明確な識別**: LLMベースと埋め込みベースの手法を透明性高く区別
- **メタデータ駆動評価**: 使用した比較手法、モデル名、応答時間などの詳細メタデータによる透明性の高い評価
- **エンタープライズ統合**: 設定管理、キャッシング、メトリクス収集による企業環境対応
- **継続的品質保証**: 自動テスト、エラー追跡、パフォーマンス監視による運用品質確保

## Key Value Proposition
- **高精度な日本語処理**: 日本語に特化した埋め込みモデルによる意味的類似度計算
- **LLMとの統合**: vLLM APIによる最新の言語モデルを活用した高度な比較
- **ハイブリッド評価**: 埋め込みベースとLLMベースの手法を組み合わせた柔軟な評価
- **即座に利用可能**: uvxによるゼロインストール実行
- **開発者フレンドリー**: CLI、Web UI、APIの3つのインターフェース提供
- **拡張可能**: Python APIとしても利用可能、カスタム統合が容易
- **信頼性**: JSON修復機能により不完全なデータでも処理継続
- **定量的評価**: 0-1のスコアと意味カテゴリによる明確な評価基準
- **エンタープライズ対応**: 構造化ログ、メトリクス収集、エラーIDによる追跡
- **運用性**: ログローテーション、システムリソース監視、詳細なエラーレポート
- **キャッシング機能**: LLM応答のキャッシングによる処理効率化
- **テスト自動化**: Playwright MCP導入済み、軽量ラッパーによる効率的なテスト実装
- **透明性と検証可能性**: 比較手法の明示的識別により、どの手法でどのスコアが算出されたかを完全に追跡可能
- **品質保証機能**: 同一データで異なる手法が同じ結果を出力する異常を自動検出し、計算方法の妥当性を保証

## Success Metrics
- 類似度計算の精度: コサイン類似度による定量評価
- LLM判定精度: プロンプトベースの意味理解精度
- 処理速度: CPUで実用的速度、GPUで高速処理、LLMキャッシュによる応答改善
- 使いやすさ: コマンド一つで実行可能なシンプルさ
- 可用性: uvx経由での即座のアクセス性
- 拡張性: 新しいLLMモデルやプロンプトテンプレートの容易な追加
- テスト品質: Playwright MCPによる包括的なE2Eテストカバレッジ（43テスト、100%成功率）
- システム透明性: 比較手法識別とメタデータ追跡による完全な監査可能性
- 運用効率: キャッシングシステムによる30%以上の処理時間短縮
- エラー回復力: 包括的エラーハンドリングと自動リトライによる高い可用性
- 設定管理: YAML/環境変数による柔軟な設定とバリデーション
- LLM機能実装進捗: 54.5%完了（6/10タスクグループ実装済み、実装準備完了）
- 出力形式精度: スコア/ファイル形式の適切な差別化とメタデータ一貫性
- プロンプト解析精度: マークダウンボールド形式対応による解析成功率向上